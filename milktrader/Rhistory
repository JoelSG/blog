require(milk)
getSymbols('AAPL', from='1900-01-01')
AAPL$RET = dailyReturn(Cl(AAPL))
AAPL$gap = ifelse((Op(AAPL)-lag(Cl(AAPL)))/lag(Cl(AAPL)) < -0.04, 1,0)
apple = AAPL[AAPL$gap == 1]
nrow(apple)
A = apple[-78,]
png('apple.png')
zeroplot(A$RET, main='AAPL', up.col = 'lightgreen', dn.col='lightpink2', xlab='Daily return after a gap down of greater\n than 4% since 1987')
